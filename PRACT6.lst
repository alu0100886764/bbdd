SQL> SPOOL
currently spooling to PRACT6.lst
SQL> SELECT SYSDATE
  2  FROM DUAL;

SYSDATE                                                                         
---------                                                                       
15-NOV-17                                                                       

SQL> SELECT SYSTIME
  2  FROM DUAL;
SELECT SYSTIME
       *
ERROR at line 1:
ORA-00904: "SYSTIME": invalid identifier 


SQL> SELECT SYSTIMESTAMP
  2  FROM DUAL;

SYSTIMESTAMP                                                                    
---------------------------------------------------------------------------     
15-NOV-17 01.26.20.423586 PM +00:00                                             

SQL> SELECT SYSDATE
  2  FROM DUAL;

SYSDATE                                                                         
---------                                                                       
15-NOV-17                                                                       

SQL> SELECT SYSTIMESTAMP
  2  FROM DUAL;

SYSTIMESTAMP                                                                    
---------------------------------------------------------------------------     
15-NOV-17 01.27.38.826412 PM +00:00                                             

SQL> SELECT CURRENT_TIMESTAMP
  2  FROM DUAL;

CURRENT_TIMESTAMP                                                               
---------------------------------------------------------------------------     
15-NOV-17 01.28.31.337550 PM +00:00                                             

SQL> SELECT CURRENT_DATE
  2  FROM DUAL;

CURRENT_D                                                                       
---------                                                                       
15-NOV-17                                                                       

SQL> SELECT TO_CHAR(SYSDATE,'HH:MI:SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
01:29:34                                                                        

SQL> SELECT TO_CHAR(SYSDATE,'HH-MI-SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
01-32-17                                                                        

SQL> ALTER TABLE DEPARTAMENTO
  2  ADD (D TIMESTAMP(8) DEFAULT SYSTIMESTAMP(8));
ADD (D TIMESTAMP(8) DEFAULT SYSTIMESTAMP(8))
     *
ERROR at line 2:
ORA-01430: column being added already exists in table 


SQL> ALTER TABLE DEPARTAMENTO
  2  ADD (D1 TIMESTAMP(8) DEFAULT SYSTIMESTAMP(8));

Table altered.

SQL> SELECT *
  2  FROM DEPARTAMENTO;

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         1 ANALISIS MATEMATICO                                                  
15-NOV-17 01.34.56.47270000 PM                                                  
                                                                                
         2 ASTROFISICA                                                          
15-NOV-17 01.34.56.47270000 PM                                                  
                                                                                
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
15-NOV-17 01.34.56.47270000 PM                                                  
                                                                                

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         4 MATEMATICA FUNDAMENTAL                                               
15-NOV-17 01.34.56.47270000 PM                                                  
                                                                                

SQL> SELECT D1
  2  FROM DEPARTAMENTO;

D1                                                                              
---------------------------------------------------------------------------     
15-NOV-17 01.34.56.47270000 PM                                                  
15-NOV-17 01.34.56.47270000 PM                                                  
15-NOV-17 01.34.56.47270000 PM                                                  
15-NOV-17 01.34.56.47270000 PM                                                  

SQL> ALTER TABLE DEPARTAMENTO
  2  DROP COLUMN D1;

Table altered.

SQL> SELECT D1
  2  FROM DEPARTAMENTO;
SELECT D1
       *
ERROR at line 1:
ORA-00904: "D1": invalid identifier 


SQL> DROP TABLE DEPARTAMENTO;
DROP TABLE DEPARTAMENTO
           *
ERROR at line 1:
ORA-02449: unique/primary keys in table referenced by foreign keys 


SQL> DESCRIBE DEPARTAMENTO;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(60)

SQL> ALTER TABLE DEPARTAMENTO
  2  MODIFY (D VARCHAR2(50);
MODIFY (D VARCHAR2(50)
                     *
ERROR at line 2:
ORA-00907: missing right parenthesis 


SQL> MODIFY (D VARCHAR2(50));
SP2-0734: unknown command beginning "MODIFY (D ..." - rest of line ignored.
SQL> ALTER TABLE DEPARTAMENTO
  2  MODIFY (D VARCHAR2(50));

Table altered.

SQL> DESCRIBE DEPARTAMENTO;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(50)

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE
  3  WHERE(FF=NULL)
  4  GROUP BY DNI
  5  HAVING COUNT (*) > 2;

no rows selected

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE
  3  WHERE(FF=NULL)
  4  GROUP BY DNI;

no rows selected

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE
  3  WHERE(FF=NULL);

no rows selected

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE
  3  WHERE(FF='NULL');
WHERE(FF='NULL')
         *
ERROR at line 3:
ORA-01858: a non-numeric character was found where a numeric was expected 


SQL> SELECT DNI
  2  ;

*
ERROR at line 2:
ORA-00923: FROM keyword not found where expected 


SQL> ALTER TABLE DEPARTAMENTO
  2  ;

*
ERROR at line 2:
ORA-02210: no options specified for ALTER TABLE 


SQL> DESCRIBE DEPARTAMENTO
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(50)

SQL> ALTER TABLE DEPARTAMENTO
  2  MODIFY (D VARCHAR2(60));

Table altered.

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE
  3  WHERE(SELECT CAS,T
  4  FROM ASIGNATURA);
FROM ASIGNATURA)
               *
ERROR at line 4:
ORA-00936: missing expression 


SQL> SPOOL OFF
SQL> SELECT SYSDATE
  2  FROM DUAL;

SYSDATE                                                                         
---------                                                                       
25-NOV-17                                                                       

SQL> SELECT TO_CHAR(SYSDATE, 'HH:MI:SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
12:54:06                                                                        

SQL> SELECT TO_CHAR (SYSDATE, 'DAY DD:MM:YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAYDD:MM:YYYY')                                                
-----------------------------------------------                                 
SATURDAY  25:11:2017                                                            

SQL> SELECT TO_CHAR(SYSDATE, 'HH:MI:SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
01:03:19                                                                        

SQL> SELECT TO_CHAR(SYSDATE, 'HH24:MI:SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
13:03:30                                                                        

SQL> SELECT TRUNC(SYSDATE-FI)
  2  FROM PLAN_DOCENTE
  3  WHERE CAS=11 AND DNI=8888 AND FF IS NULL;

TRUNC(SYSDATE-FI)                                                               
-----------------                                                               
             3007                                                               

SQL> SELECT (SYSDATE-FI)
  2  FROM PLAN_DOCENTE
  3  WHERE CAS=11 AND DNI=8888 AND FF IS NULL;

(SYSDATE-FI)                                                                    
------------                                                                    
   3007.5464                                                                    

SQL> SELECT DNI FROM PLAN_DOCENTE
  2  WHERE FF IS NULL AND TRUNC(SYSDATE-F)>365;
WHERE FF IS NULL AND TRUNC(SYSDATE-F)>365
                                   *
ERROR at line 2:
ORA-00904: "F": invalid identifier 


SQL> SELECT DNI FROM PLAN_DOCENTE
  2  WHERE FF IS NULL AND TRUNC(SYSDATE-FI)>365;

       DNI                                                                      
----------                                                                      
      4444                                                                      
      4444                                                                      
      1111                                                                      
      3030                                                                      
      2222                                                                      
      3333                                                                      
      1010                                                                      
      9999                                                                      
      5555                                                                      
      8888                                                                      
      2020                                                                      

       DNI                                                                      
----------                                                                      
      7777                                                                      
      3333                                                                      

13 rows selected.

SQL> SELECT P
  2  FROM PROFESOR
  3  WHERE DNI IN (SELECT DNI FROM PLAN_DOCENTE
  4  WHERE FF IS NULL AND TRUNC(SYSDATE-FI)>365);

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
CARLOS                                                                          
PEDRO                                                                           
MARIA                                                                           
IVAN                                                                            
MARIO                                                                           
FRANCISCO                                                                       
ANGELA                                                                          
DAVID                                                                           
SOLEDAD                                                                         
JOSE MANUEL                                                                     

11 rows selected.

SQL> SELECT P
  2  FROM PROFESOR
  3  WHERE DNI IN (SELECT DNI FROM PLAN_DOCENTE
  4  WHERE TRUNC(SYSDATE-FI)>365);

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
CARLOS                                                                          
PEDRO                                                                           
MARIA                                                                           
IVAN                                                                            
CARMEN                                                                          
MARIO                                                                           
FRANCISCO                                                                       
ANGELA                                                                          
DAVID                                                                           
SOLEDAD                                                                         

P                                                                               
------------------------------------------------------------                    
JOSE MANUEL                                                                     

12 rows selected.

SQL> SELECT P
  2  FROM PROFESOR
  3  WHERE DNI IN (SELECT DNI FROM PLAN_DOCENTE
  4  WHERE (TRUNC(SYSDATE-FI))>365);

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
CARLOS                                                                          
PEDRO                                                                           
MARIA                                                                           
IVAN                                                                            
CARMEN                                                                          
MARIO                                                                           
FRANCISCO                                                                       
ANGELA                                                                          
DAVID                                                                           
SOLEDAD                                                                         

P                                                                               
------------------------------------------------------------                    
JOSE MANUEL                                                                     

12 rows selected.

SQL> SELECT P
  2  FROM PROFESOR
  3  WHERE DNI IN (SELECT DNI FROM PLAN_DOCENTE
  4  WHERE (SYSDATE-FI)>365);

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
CARLOS                                                                          
PEDRO                                                                           
MARIA                                                                           
IVAN                                                                            
CARMEN                                                                          
MARIO                                                                           
FRANCISCO                                                                       
ANGELA                                                                          
DAVID                                                                           
SOLEDAD                                                                         

P                                                                               
------------------------------------------------------------                    
JOSE MANUEL                                                                     

12 rows selected.

SQL> SELECT P
  2  FROM PROFESOR
  3  WHERE DNI IN (SELECT DNI FROM PLAN_DOCENTE
  4  WHERE (FF IS NULL AND SYSDATE-FI>365) OR
  5  (FF IS NOT NILL AND FF-FI>365));
(FF IS NOT NILL AND FF-FI>365))
    *
ERROR at line 5:
ORA-00908: missing NULL keyword 


SQL> SELECT P
  2  FROM PROFESOR
  3  WHERE DNI IN (SELECT DNI FROM PLAN_DOCENTE
  4  WHERE (FF IS NULL AND SYSDATE-FI>365) OR
  5  (FF IS NOT NULL AND FF-FI>365));

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
CARLOS                                                                          
PEDRO                                                                           
MARIA                                                                           
IVAN                                                                            
CARMEN                                                                          
MARIO                                                                           
FRANCISCO                                                                       
ANGELA                                                                          
DAVID                                                                           
SOLEDAD                                                                         

P                                                                               
------------------------------------------------------------                    
JOSE MANUEL                                                                     

12 rows selected.

SQL> SELECT * FROM AREA NATURAL JOIN DEPARTAMENTO;

        CD        CAR                                                           
---------- ----------                                                           
AR                                                                              
------------------------------------------------------------                    
D                                                                               
------------------------------------------------------------                    
         1          5                                                           
DIDACTICA DE LA MATEMATICA                                                      
ANALISIS MATEMATICO                                                             
                                                                                
         1          2                                                           
ANALISIS MATEMATICO                                                             
ANALISIS MATEMATICO                                                             

        CD        CAR                                                           
---------- ----------                                                           
AR                                                                              
------------------------------------------------------------                    
D                                                                               
------------------------------------------------------------                    
                                                                                
         1          8                                                           
MATEMATICA APLICADA                                                             
ANALISIS MATEMATICO                                                             
                                                                                
         2          3                                                           
ASTRONOMIA Y ASTROFISICA                                                        

        CD        CAR                                                           
---------- ----------                                                           
AR                                                                              
------------------------------------------------------------                    
D                                                                               
------------------------------------------------------------                    
ASTROFISICA                                                                     
                                                                                
         3          4                                                           
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                            
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                              
                                                                                
         3          6                                                           

        CD        CAR                                                           
---------- ----------                                                           
AR                                                                              
------------------------------------------------------------                    
D                                                                               
------------------------------------------------------------                    
ESTADISTICA E INVESTIGACION OPERATIVA                                           
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                              
                                                                                
         3          7                                                           
LENGUAJES Y SISTEMAS INFORMATICOS                                               
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                              
                                                                                

        CD        CAR                                                           
---------- ----------                                                           
AR                                                                              
------------------------------------------------------------                    
D                                                                               
------------------------------------------------------------                    
         4          1                                                           
ALGEBRA                                                                         
MATEMATICA FUNDAMENTAL                                                          
                                                                                

8 rows selected.

SQL> SELECT AR FROM AREA NATURAL JOIN DEPARTAMENTO
  2  WHERE D='ASTROFISICA';

AR                                                                              
------------------------------------------------------------                    
ASTRONOMIA Y ASTROFISICA                                                        

SQL> SELECT COUNT(P)
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR IN(SELECT AR FROM AREA NATURAL JOIN DEPARTAMENTO
  4  WHERE D='ASTROFISICA');

  COUNT(P)                                                                      
----------                                                                      
         1                                                                      

SQL> SELECT DEPARTAMENTO.D, COUNT(DISTINCT DNI) N_PROF
  2  FROM PROFESOR, AREA, DEPARTAMENTO
  3  WHERE PROFESOR.CAR = AREA.CAR AND AREA.CD = DEPARTAMENTO.CD
  4  GROUP BY DEPARTAMENTO.D
  5  GROUP BY DEPARTAMENTO.D;
GROUP BY DEPARTAMENTO.D
*
ERROR at line 5:
ORA-01787: only one clause allowed per query block 


SQL> SELECT DEPARTAMENTO.D, COUNT(DISTINCT DNI) N_PROF
  2  FROM PROFESOR, AREA, DEPARTAMENTO
  3  WHERE PROFESOR.CAR = AREA.CAR AND AREA.CD = DEPARTAMENTO.CD
  4  GROUP BY DEPARTAMENTO.D;

D                                                                N_PROF         
------------------------------------------------------------ ----------         
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                    7         
ASTROFISICA                                                           1         
ANALISIS MATEMATICO                                                   3         
MATEMATICA FUNDAMENTAL                                                1         

SQL> RUN SELECT D, COUNT(P)
  1  SELECT DEPARTAMENTO.D, COUNT(DISTINCT DNI) N_PROF
  2  FROM PROFESOR, AREA, DEPARTAMENTO
  3  WHERE PROFESOR.CAR = AREA.CAR AND AREA.CD = DEPARTAMENTO.CD
  4* GROUP BY DEPARTAMENTO.D

D                                                                N_PROF         
------------------------------------------------------------ ----------         
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                    7         
ASTROFISICA                                                           1         
ANALISIS MATEMATICO                                                   3         
MATEMATICA FUNDAMENTAL                                                1         

SQL> RUN SELECT D, COUNT(P)
  1  SELECT DEPARTAMENTO.D, COUNT(DISTINCT DNI) N_PROF
  2  FROM PROFESOR, AREA, DEPARTAMENTO
  3  WHERE PROFESOR.CAR = AREA.CAR AND AREA.CD = DEPARTAMENTO.CD
  4* GROUP BY DEPARTAMENTO.D

D                                                                N_PROF         
------------------------------------------------------------ ----------         
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                    7         
ASTROFISICA                                                           1         
ANALISIS MATEMATICO                                                   3         
MATEMATICA FUNDAMENTAL                                                1         

SQL> SELECT D, COUNT(P)
  2  FROM PROFESOR NATURAL JOIN AREA, DEPARTAMENTO
  3  WHERE AREA.CD=DEPARTAMENTO.CD
  4  GROUP BY D
  5  GROUP BY D;
GROUP BY D
*
ERROR at line 5:
ORA-01787: only one clause allowed per query block 


SQL> RUN SELECT D, COUNT(P) FROM PROFESOR NATURAL JOIN AREA, DEPARTAMENTO WHERE AREA.CD=DEPARTAMENTO.CD GROUP BY D
  1  SELECT D, COUNT(P)
  2  FROM PROFESOR NATURAL JOIN AREA, DEPARTAMENTO
  3  WHERE AREA.CD=DEPARTAMENTO.CD
  4  GROUP BY D
  5* GROUP BY D
GROUP BY D
*
ERROR at line 5:
ORA-01787: only one clause allowed per query block 


SQL> SELECT D, COUNT(P)
  2  FROM PROFESOR NATURAL JOIN AREA, DEPARTAMENTO
  3  WHERE AREA.CD=DEPARTAMENTO.CD
  4  GROUP BY D
  5  ORDER BY D;

D                                                              COUNT(P)         
------------------------------------------------------------ ----------         
ANALISIS MATEMATICO                                                   3         
ASTROFISICA                                                           1         
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                    7         
MATEMATICA FUNDAMENTAL                                                1         

SQL> SELECT D, COUNT(P)
  2  FROM PROFESOR NATURAL JOIN AREA, DEPARTAMENTO
  3  WHERE AREA.CD=DEPARTAMENTO.CD
  4  GROUP BY D;

D                                                              COUNT(P)         
------------------------------------------------------------ ----------         
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                    7         
ASTROFISICA                                                           1         
ANALISIS MATEMATICO                                                   3         
MATEMATICA FUNDAMENTAL                                                1         

SQL> SELECT *
  2  FROM PROFESOR NATURAL JOIN AREA, DEPARTAMENTO
  3  WHERE AREA.CD=DEPARTAMENTO.CD
  4  ;

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         6       1111                                                           
JUAN                                                         CU                 
ESTADISTICA E INVESTIGACION OPERATIVA                                 3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         7       2222                                                           
CARLOS                                                       TU                 
LENGUAJES Y SISTEMAS INFORMATICOS                                     3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         4       3333                                                           
PEDRO                                                        TEU                
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                  3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         7       4444                                                           
MARIA                                                        TU                 
LENGUAJES Y SISTEMAS INFORMATICOS                                     3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         1       5555                                                           
IVAN                                                         CEU                
ALGEBRA                                                               4         
         4 MATEMATICA FUNDAMENTAL                                               
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         3       6666                                                           
CARMEN                                                       CD                 
ASTRONOMIA Y ASTROFISICA                                              2         
         2 ASTROFISICA                                                          
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         2       7777                                                           
MARIO                                                        TU                 
ANALISIS MATEMATICO                                                   1         
         1 ANALISIS MATEMATICO                                                  
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         5       8888                                                           
FRANCISCO                                                    TU                 
DIDACTICA DE LA MATEMATICA                                            1         
         1 ANALISIS MATEMATICO                                                  
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         8       9999                                                           
ANGELA                                                       TEU                
MATEMATICA APLICADA                                                   1         
         1 ANALISIS MATEMATICO                                                  
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         4       1010                                                           
DAVID                                                        TU                 
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                  3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         7       2020                                                           
SOLEDAD                                                      CU                 
LENGUAJES Y SISTEMAS INFORMATICOS                                     3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
        CD D                                                                    
---------- ------------------------------------------------------------         
         6       3030                                                           
JOSE MANUEL                                                  TEU                
ESTADISTICA E INVESTIGACION OPERATIVA                                 3         
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
                                                                                

12 rows selected.

SQL> SELECT COUNT(DISTINCT P) TITULACIONES
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA,
  3  DEPARTAMENTO NATURAL JOIN AREA
  4  WHERE ASIGNATURA.CAR = AREA.CAR AND
  5  D='ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION';
SELECT COUNT(DISTINCT P) TITULACIONES
                      *
ERROR at line 1:
ORA-00904: "P": invalid identifier 


SQL> SELECT COUNT(DISTINCT T) TITULACIONES
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA,
  3  DEPARTAMENTO NATURAL JOIN AREA
  4  WHERE ASIGNATURA.CAR = AREA.CAR AND
  5  D='ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION';

TITULACIONES                                                                    
------------                                                                    
           2                                                                    

SQL> SELECT *
  2  FROM PROFESOR NATURAL JOIN AREA;

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
         1       5555                                                           
IVAN                                                         CEU                
ALGEBRA                                                               4         
                                                                                
         2       7777                                                           
MARIO                                                        TU                 
ANALISIS MATEMATICO                                                   1         

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
                                                                                
         3       6666                                                           
CARMEN                                                       CD                 
ASTRONOMIA Y ASTROFISICA                                              2         
                                                                                
         4       1010                                                           
DAVID                                                        TU                 

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                  3         
                                                                                
         4       3333                                                           
PEDRO                                                        TEU                
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                  3         
                                                                                
         5       8888                                                           

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
FRANCISCO                                                    TU                 
DIDACTICA DE LA MATEMATICA                                            1         
                                                                                
         6       1111                                                           
JUAN                                                         CU                 
ESTADISTICA E INVESTIGACION OPERATIVA                                 3         
                                                                                

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
         6       3030                                                           
JOSE MANUEL                                                  TEU                
ESTADISTICA E INVESTIGACION OPERATIVA                                 3         
                                                                                
         7       2222                                                           
CARLOS                                                       TU                 
LENGUAJES Y SISTEMAS INFORMATICOS                                     3         

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
                                                                                
         7       4444                                                           
MARIA                                                        TU                 
LENGUAJES Y SISTEMAS INFORMATICOS                                     3         
                                                                                
         7       2020                                                           
SOLEDAD                                                      CU                 

       CAR        DNI                                                           
---------- ----------                                                           
P                                                            CAT                
------------------------------------------------------------ -----              
AR                                                                   CD         
------------------------------------------------------------ ----------         
LENGUAJES Y SISTEMAS INFORMATICOS                                     3         
                                                                                
         8       9999                                                           
ANGELA                                                       TEU                
MATEMATICA APLICADA                                                   1         
                                                                                

12 rows selected.

SQL> SELECT COUNT(DNI)
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%';

COUNT(DNI)                                                                      
----------                                                                      
         3                                                                      

SQL> SPOOL OFF
SQL> SELECT T TITULACION, COUNT(CAS)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;

TITU COUNT(CAS)                                                                 
---- ----------                                                                 
GF            1                                                                 
GII           7                                                                 
GM            2                                                                 
MII           2                                                                 

SQL> SELECT T TITULACION, COUNT(CAS)
  2  FROM ASIGNATURA
  3  ORDER BY T;
SELECT T TITULACION, COUNT(CAS)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT T TITULACION, COUNT(CAS)
  2  FROM ASIGNATURA;
SELECT T TITULACION, COUNT(CAS)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT T TITULACION, COUNT(CAS)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;

TITU COUNT(CAS)                                                                 
---- ----------                                                                 
GF            1                                                                 
GII           7                                                                 
GM            2                                                                 
MII           2                                                                 

SQL> SELECT T TITULACION, COUNT(T)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;

TITU   COUNT(T)                                                                 
---- ----------                                                                 
GF            1                                                                 
GII           7                                                                 
GM            2                                                                 
MII           2                                                                 

SQL> SELECT T, COUNT(A)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;

T      COUNT(A)                                                                 
---- ----------                                                                 
GF            1                                                                 
GII           7                                                                 
GM            2                                                                 
MII           2                                                                 

SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT=(SELECT MAX(CT)
  4  FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ENSENANZA DE LA MATEMATICA                                                      

SQL> SELECT MAX(CT)
  2  FROM ASIGNATURA;

   MAX(CT)                                                                      
----------                                                                      
         6                                                                      

SQL> SELECT MAX(A)
  2  FROM ASIGNATURA;

MAX(A)                                                                          
--------------------------------------------------                              
OPTIMIZACION                                                                    

SQL> SELECT A
  2  FROM ASIGNATURA;

A                                                                               
--------------------------------------------------                              
BASES DE DATOS                                                                  
INTELIGENCIA ARTIFICIAL                                                         
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                
INFORMATICA BASICA                                                              
ALGEBRA                                                                         
CALCULO                                                                         
OPTIMIZACION                                                                    
GESTION DE RIESGOS                                                              
ASTRONOMIA                                                                      
ENSENANZA DE LA MATEMATICA                                                      

A                                                                               
--------------------------------------------------                              
ANALISIS COMPLEJO                                                               

12 rows selected.

SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT=(SELECT MIN(CT)
  4  FROM ASIGNATURA;
WHERE CT=(SELECT MIN(CT)
          *
ERROR at line 3:
ORA-00921: unexpected end of SQL command 


SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT IN (SELECT MIN(CT)
  4  FROM ASIGNATURA;
FROM ASIGNATURA
              *
ERROR at line 4:
ORA-00907: missing right parenthesis 


SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT=(SELECT MIN(CT)
  4  FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
INTELIGENCIA ARTIFICIAL                                                         
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                

SQL> SELECT A ASIGNATURA, COUNT(CT+CP+CL) CREDITOS TOTALES
  2  FROM ASIGNATURA;
SELECT A ASIGNATURA, COUNT(CT+CP+CL) CREDITOS TOTALES
                                              *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT A ASIGNATURA, COUNT(CT+CP+CL) CREDITOS
  2  FROM ASIGNATURA;
SELECT A ASIGNATURA, COUNT(CT+CP+CL) CREDITOS
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT A ASIGNATURA,(CT+CP+CL) CREDITOS
  2  FROM ASIGNATURA
  3  GROUP BY A;
SELECT A ASIGNATURA,(CT+CP+CL) CREDITOS
                     *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT A ASIGNATURA,(CT+CP+CL)
  2  FROM ASIGNATURA;

ASIGNATURA                                         (CT+CP+CL)                   
-------------------------------------------------- ----------                   
BASES DE DATOS                                              6                   
INTELIGENCIA ARTIFICIAL                                     6                   
ALMACENES DE DATOS                                          3                   
MINERIA DE DATOS                                            3                   
INFORMATICA BASICA                                          6                   
ALGEBRA                                                     6                   
CALCULO                                                     6                   
OPTIMIZACION                                                6                   
GESTION DE RIESGOS                                          6                   
ASTRONOMIA                                                  6                   
ENSENANZA DE LA MATEMATICA                                  6                   

ASIGNATURA                                         (CT+CP+CL)                   
-------------------------------------------------- ----------                   
ANALISIS COMPLEJO                                         7.5                   

12 rows selected.

SQL> SELECT MAX(CT+CP+CL)
  2  FROM ASIGNATURA);
FROM ASIGNATURA)
               *
ERROR at line 2:
ORA-00933: SQL command not properly ended 


SQL> SELECT MAX(CT+CP+CL)
  2  FROM ASIGNATURA;

MAX(CT+CP+CL)                                                                   
-------------                                                                   
          7.5                                                                   

SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE (CT+CP+CL)=(SELECT MAX(CT+CP+CL)
  4  FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ANALISIS COMPLEJO                                                               

SQL> SELECT A ASIGNATURA
  2  FROM ASIGNATURA
  3  WHERE (CT+CP+CL)=(SELECT MIN(CT+CP+CL)
  4  FROM ASIGNATURA);

ASIGNATURA                                                                      
--------------------------------------------------                              
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                

SQL> SELECT CAR
  2  FROM ASIGNATURA
  3  WHERE MAX(CT+CP+CL);
WHERE MAX(CT+CP+CL)
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SELECT CAR
  2  FROM ASIGNATURA
  3  WHERE (CT+CP+CL) IN (SELECT(CT+CP+CL)
  4  FROM ASIGNATURA);

       CAR                                                                      
----------                                                                      
         7                                                                      
         4                                                                      
         7                                                                      
         1                                                                      
         8                                                                      
         6                                                                      
         4                                                                      
         3                                                                      
         5                                                                      
         7                                                                      
         7                                                                      

       CAR                                                                      
----------                                                                      
         2                                                                      

12 rows selected.

SQL> SELECT CAR
  2  FROM ASIGNATURA
  3  WHERE (CT+CP+CL) IN (SELECT MAX(CT+CP+CL)
  4  FROM ASIGNATURA);

       CAR                                                                      
----------                                                                      
         2                                                                      

SQL> SELECT CAR
  2  FROM ASIGNATURA
  3  WHERE (CT+CP+CL)=(SELECT MAX(CT+CP+CL)
  4  FROM ASIGNATURA);

       CAR                                                                      
----------                                                                      
         2                                                                      

SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  WHERE CAR IN (SELECT CAR
  4  FROM ASIGNATURA
  5  WHERE (CT+CP+CL)=(SELECT MAX(CT+CP+CL)
  6  FROM ASIGNATURA));

AR                                                                              
------------------------------------------------------------                    
ANALISIS MATEMATICO                                                             

SQL> SELECT CAS
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

       CAS                                                                      
----------                                                                      
         8                                                                      
         8                                                                      

SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CAS IN(SELECT CAS
  4  FROM PLAN_DOCENTE
  5  WHERE DNI=1111);

A                                                                               
--------------------------------------------------                              
OPTIMIZACION                                                                    

SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CAS IN(SELECT COUNT(CAS)
  4  FROM PLAN_DOCENTE
  5  WHERE DNI=1111);

A                                                                               
--------------------------------------------------                              
INTELIGENCIA ARTIFICIAL                                                         

SQL> SELECT COUNT(A)
  2  FROM ASIGNATURA
  3  WHERE CAS IN(SELECT CAS
  4  FROM PLAN_DOCENTE
  5  WHERE DNI=1111);

  COUNT(A)                                                                      
----------                                                                      
         1                                                                      

SQL> SELECT COUNT(A) N_ASIGNATURAS
  2  FROM ASIGNATURA
  3  WHERE CAS IN(SELECT CAS
  4  FROM PLAN_DOCENTE
  5  WHERE DNI=1111);

N_ASIGNATURAS                                                                   
-------------                                                                   
            1                                                                   

SQL> SELECT SUM(CTA+CPA+CLA)
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
               9                                                                

SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE
  3  ;
SELECT MAX(SUM(CTA+CPA+CLA))
           *
ERROR at line 1:
ORA-00978: nested group function without GROUP BY 


SQL> SELECT P
  2  FROM PROFESOR NATURAL JOIN PLAN_DOCENTE
  3  WHERE FF IS NULL
  4  GROUP BY P, DNI
  5  HAVING SUM(CTA+CPA+CLA) >= ALL(SELECT SUM(CPA+CTA+CLA)
  6  FROM PLAN_DOCENTE
  7  WHERE FF IS NULL
  8  GROUP BY DNI);

P                                                                               
------------------------------------------------------------                    
MARIA                                                                           
PEDRO                                                                           

SQL> ALL(SELECT SUM(CPA+CTA+CLA)
SP2-0734: unknown command beginning "ALL(SELECT..." - rest of line ignored.
SQL> ALL (SELECT SUM(CPA+CTA+CLA)
SP2-0734: unknown command beginning "ALL (SELEC..." - rest of line ignored.
SQL> SELECT SUM(CTA+CPA+CLA) >= ALL(SELECT SUM(CPA+CTA+CLA)
  2  FROM PLAN_DOCENTE
  3  WHERE FF IS NULL
  4  GROUP BY DNI);
SELECT SUM(CTA+CPA+CLA) >= ALL(SELECT SUM(CPA+CTA+CLA)
                        *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT AR, A
  2  FROM AREA NATURAL JOIN ASIGNATURA;

AR                                                                              
------------------------------------------------------------                    
A                                                                               
--------------------------------------------------                              
ALGEBRA                                                                         
ALGEBRA                                                                         
                                                                                
ANALISIS MATEMATICO                                                             
ANALISIS COMPLEJO                                                               
                                                                                
ASTRONOMIA Y ASTROFISICA                                                        
ASTRONOMIA                                                                      
                                                                                

AR                                                                              
------------------------------------------------------------                    
A                                                                               
--------------------------------------------------                              
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                            
GESTION DE RIESGOS                                                              
                                                                                
CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                            
INTELIGENCIA ARTIFICIAL                                                         
                                                                                
DIDACTICA DE LA MATEMATICA                                                      
ENSENANZA DE LA MATEMATICA                                                      
                                                                                

AR                                                                              
------------------------------------------------------------                    
A                                                                               
--------------------------------------------------                              
ESTADISTICA E INVESTIGACION OPERATIVA                                           
OPTIMIZACION                                                                    
                                                                                
LENGUAJES Y SISTEMAS INFORMATICOS                                               
INFORMATICA BASICA                                                              
                                                                                
LENGUAJES Y SISTEMAS INFORMATICOS                                               
MINERIA DE DATOS                                                                
                                                                                

AR                                                                              
------------------------------------------------------------                    
A                                                                               
--------------------------------------------------                              
LENGUAJES Y SISTEMAS INFORMATICOS                                               
ALMACENES DE DATOS                                                              
                                                                                
LENGUAJES Y SISTEMAS INFORMATICOS                                               
BASES DE DATOS                                                                  
                                                                                
MATEMATICA APLICADA                                                             
CALCULO                                                                         
                                                                                

12 rows selected.

SQL> SELECT AR, COUNT(A)
  2  FROM AREA NATURAL JOIN ASIGNATURA;
SELECT AR, COUNT(A)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT AVG(COUNT(A))
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(A))                                                                   
-------------                                                                   
          1.5                                                                   

SQL> SELECT A
  2  FROM ASIGNATURA
  3  GROUP BY CAR;
SELECT A
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT AVG(COUNT(P)) MEDIA
  2  FROM PROFESOR
  3  GROUP BY CAR;

     MEDIA                                                                      
----------                                                                      
       1.5                                                                      

SQL> SELECT AVG(COUNT(P)) MEDIA
  2  FROM PROFESOR NATURAL JOIN AREA
  3  GROUP BY CD;

     MEDIA                                                                      
----------                                                                      
         3                                                                      

SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  GROUP BY AR
  4  HAVING COUNT(CAS)>3;

AR                                                                              
------------------------------------------------------------                    
LENGUAJES Y SISTEMAS INFORMATICOS                                               

SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  GROUP BY AR
  4  HAVING COUNT(DISTINCT CAS)>3;

AR                                                                              
------------------------------------------------------------                    
LENGUAJES Y SISTEMAS INFORMATICOS                                               

SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  GROUP BY AR
  4  HAVING COUNT(DISTINCT CAS)>6;

no rows selected

SQL> SELECT D
  2  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  3  GROUP BY D
  4  HAVING COUNT(P) <= (SELECT MIN(COUNT(P))
  5  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  6  GROUP BY D;
HAVING COUNT(P) <= (SELECT MIN(COUNT(P))
                    *
ERROR at line 4:
ORA-00921: unexpected end of SQL command 


SQL> SELECT D
  2  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  3  GROUP BY D
  4  HAVING COUNT(P) <= (SELECT MIN(COUNT(P))
  5  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  6  GROUP BY D);

D                                                                               
------------------------------------------------------------                    
ASTROFISICA                                                                     
MATEMATICA FUNDAMENTAL                                                          

SQL> SELECT MIN(COUNT(P))
  2  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  3  GROUP BY D;

MIN(COUNT(P))                                                                   
-------------                                                                   
           12                                                                   

SQL> SELECT D
  2  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  3  GROUP BY D
  4  HAVING COUNT(P) = (SELECT MIN(COUNT(P))
  5  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  6  GROUP BY D);

D                                                                               
------------------------------------------------------------                    
ASTROFISICA                                                                     
MATEMATICA FUNDAMENTAL                                                          

SQL> SELECT D
  2  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  3  WHERE COUNT(P) = (SELECT MIN(COUNT(P))
  4  FROM DEPARTAMENTO NATURAL JOIN AREA, PROFESOR
  5  GROUP BY D);
WHERE COUNT(P) = (SELECT MIN(COUNT(P))
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SPOOL OFF
